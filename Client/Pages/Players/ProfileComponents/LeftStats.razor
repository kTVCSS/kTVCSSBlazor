@using kTVCSSBlazor.Db.Models.Players
@inject DialogService DialogService
@inject TooltipService tooltipService 

<RadzenCard Style="height: 655px; overflow: auto">
    <RadzenRow>
        <RadzenColumn SizeXS="12" SizeMD="6">
            <RadzenStack Wrap="FlexWrap.Wrap">
                @* Рейтинг *@
                <RadzenCard Variant="Radzen.Variant.Outlined">
                    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="1rem" AlignItems="Radzen.AlignItems.Center" Wrap="Radzen.FlexWrap.NoWrap">
                        <img src="@player.RankUrl" alt="User Profile" style="width: 56px; height: 100%; border-radius: 50%;">
                        <RadzenStack Gap="0">
                            <RadzenText Text="Рейтинг" TextStyle="Radzen.Blazor.TextStyle.Overline" TagName="Radzen.Blazor.TagName.H4" class="rz-mb-1" />
                            <RadzenText Style="word-break: break-all" Text="@player.MainInfo.MMR.ToString()" TagName="Radzen.Blazor.TagName.P" TextStyle="Radzen.Blazor.TextStyle.H5" />
                        </RadzenStack>
                    </RadzenStack>
                </RadzenCard>

                @*Роль*@
                <RadzenCard Variant="Radzen.Variant.Outlined">
                    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="1rem" AlignItems="Radzen.AlignItems.Center" Wrap="Radzen.FlexWrap.NoWrap">
                        <RadzenIcon Icon="gamepad" class="rz-background-color-primary-light rz-color-on-primary-light rz-border-radius-10" Style="font-size: 32px; min-height: 56px; min-width: 56px" />
                        <RadzenStack Gap="0">
                            <RadzenText Text="Роль" TextStyle="Radzen.Blazor.TextStyle.Overline" TagName="Radzen.Blazor.TagName.H4" class="rz-mb-1" />
                            <RadzenText Style="word-break: break-all" Text="@player.Role" TagName="Radzen.Blazor.TagName.P" TextStyle="Radzen.Blazor.TextStyle.H5" />
                        </RadzenStack>
                    </RadzenStack>
                </RadzenCard>

                @*СЫГРАНО*@
                <RadzenCard Variant="Radzen.Variant.Outlined">
                    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="1rem" AlignItems="Radzen.AlignItems.Center" Wrap="Radzen.FlexWrap.NoWrap">
                        <RadzenIcon Icon="access_time" class="rz-background-color-primary-light rz-color-on-primary-light rz-border-radius-10" Style="font-size: 32px; min-height: 56px; min-width: 56px" />
                        <RadzenStack Gap="0">
                            <RadzenText Text="Сыграно" TextStyle="Radzen.Blazor.TextStyle.Overline" TagName="Radzen.Blazor.TagName.H4" class="rz-mb-1" />
                            <RadzenText MouseEnter="@(args => ShowTotalMatches(args, player.MainInfo.MatchesTotal.Value, new TooltipOptions(){ Style = "", Duration = null }))" Style="word-break: break-all" Text="@(string.Concat(player.MainInfo.GameHours, " часов"))" TagName="Radzen.Blazor.TagName.P" TextStyle="Radzen.Blazor.TextStyle.H5" />
                        </RadzenStack>
                    </RadzenStack>
                </RadzenCard>

                @*KDR*@
                <RadzenCard Variant="Radzen.Variant.Outlined">
                    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="1rem" AlignItems="Radzen.AlignItems.Center" Wrap="Radzen.FlexWrap.NoWrap">
                        <RadzenIcon Icon="bubble_chart" class="rz-background-color-primary-light rz-color-on-primary-light rz-border-radius-10" Style="font-size: 32px; min-height: 56px; min-width: 56px" />
                        <RadzenStack Style="cursor:pointer" MouseEnter="@(args => ShowTooltipWithHtml(args, player.MainInfo.Kills.Value, player.MainInfo.Deaths.Value, new TooltipOptions(){ Style = "", Duration = null }))" Gap="0">
                            <RadzenText Text="KDR" TextStyle="Radzen.Blazor.TextStyle.Overline" TagName="Radzen.Blazor.TagName.H4" class="rz-mb-1" />
                            <RadzenText Style="word-break: break-all" Text="@player.MainInfo.KDR.ToString()" TagName="Radzen.Blazor.TagName.P" TextStyle="Radzen.Blazor.TextStyle.H5" />
                        </RadzenStack>
                    </RadzenStack>
                </RadzenCard>

                @*ENTRY*@
                <RadzenCard Variant="Radzen.Variant.Outlined">
                    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="1rem" AlignItems="Radzen.AlignItems.Center" Wrap="Radzen.FlexWrap.NoWrap">
                        <RadzenIcon Icon="open_in_browser" class="rz-background-color-primary-light rz-color-on-primary-light rz-border-radius-10" Style="font-size: 32px; min-height: 56px; min-width: 56px" />
                        <RadzenStack Gap="0">
                            <RadzenText Text="Энтри" TextStyle="Radzen.Blazor.TextStyle.Overline" TagName="Radzen.Blazor.TagName.H4" class="rz-mb-1" />
                            <RadzenText Style="word-break: break-all" Text="@player.Highlights.OpenFrags.ToString()" TagName="Radzen.Blazor.TagName.P" TextStyle="Radzen.Blazor.TextStyle.H5" />
                        </RadzenStack>
                    </RadzenStack>
                </RadzenCard>

                @*TRIPPLES*@
                <RadzenCard Variant="Radzen.Variant.Outlined">
                    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="1rem" AlignItems="Radzen.AlignItems.Center" Wrap="Radzen.FlexWrap.NoWrap">
                        <RadzenIcon Icon="3k" class="rz-background-color-primary-light rz-color-on-primary-light rz-border-radius-10" Style="font-size: 32px; min-height: 56px; min-width: 56px" />
                        <RadzenStack Gap="0">
                            <RadzenText Text="Триплы" TextStyle="Radzen.Blazor.TextStyle.Overline" TagName="Radzen.Blazor.TagName.H4" class="rz-mb-1" />
                            <RadzenText Style="word-break: break-all" Text="@player.Highlights.Tripples.ToString()" TagName="Radzen.Blazor.TagName.P" TextStyle="Radzen.Blazor.TextStyle.H5" />
                        </RadzenStack>
                    </RadzenStack>
                </RadzenCard>
            </RadzenStack>
        </RadzenColumn>

        <RadzenColumn SizeXS="12" SizeMD="6">
            <RadzenStack>
                @*Стим*@
                <RadzenCard Variant="Radzen.Variant.Outlined">
                    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="1rem" AlignItems="Radzen.AlignItems.Center" Wrap="Radzen.FlexWrap.NoWrap">
                        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADgAAAA4CAYAAACohjseAAAACXBIWXMAAAsTAAALEwEAmpwYAAAE8klEQVR4nO1aW6xcUxjeIojiRVyKB7cED5xGiAcSaatoFe2jN40ivYQHD+rBJeLy4EnKW10S156mQVpOz8y/tiERqWRUtbP/f8/RtJS4PkiooD2dT/5tOGNm7fvac45mvmQlk5l1+9b/r/+2xvNGGGGEYxofCU6jAFdSgCUmwEoKsSL6HGKs0cKp3v8NZg/ONoI1RrCZGF8bAVLaQRK8SYJ7Gy3M9+YiABxHjOUkqBnGdAZS1kaCIyR4T+fSOb25AAqxlAStoqQS2mc69+yqIuOdCoj9tzG2Dl11fcZNhvFj5eRmVPf7eoAbhkLOMNbrXRkWuR5JTqshqprchqETGyS6oRJyJLhv1snNqKxbSVKIpWXMfxXq6odY7IScWjBi/FTRZj8gxgO+4NpaiAu16Wf9jgQfpkjxOyfWlRjbKlCxT5VI2tq1ENcZwa4ESW4tRc6EWFaBeo1/fBAnZ92D9tWwL/awwoLBgIZKRrDXMblGs4kT8u5Fx+jYmHl3FQrriHGrY7X8Ne7ONEKcEWlLiGX62dZnB+McIzhknZuxPD9BQd0pQcaT/WtMTOEkEjzfGzhEnxkb9TfLoT8VM/+7ucjpSbt2C8S4xHKIb+UxIL7g0hjtOFLbh7MyE+zmcy7v3v6BNRg3po2zxZ/EOGDtH2B1HoKbHRNsWAhuzCD1Zy3jrMaGBG9kJpgxE8+jni9bNvpahnGv5vDLX2Uip3USYnQckvvFD3C+heBjGcY+MkBQsDOmb6e2G6ekEtTNGMFvDiW4xrYOtXGREfyZoNZ/NAQX9PtDEvwcN8ZvY0EmKZo2ziPGS4ZxtKT0/CQnbBh3W9f4O/e7a+DwQyxOWXNRJoL/TtjGgqL+UB27Bs9pa5BgoRartL82w5j0A1xfJC72Bbd7RaARRu7CEmO95xBRLTVlTb8oQcUW4Pg64x5NUzKQa7gs+0V2IVsNaFHpxSIrK3h8IC5k7NFwjBh36h12wszzvPcFV2lxOJPWhBhLnXBbE/NI8EJdcG5SP/3dMF6MJBpgpecYky2cbhjPEOP3jAatk8lNKDS0UgmppJLeD9SIGAFp2FWWUI1xuRGsIsHDamjUTeQ0al8WCtVUQnr39A4O5Gi92TZjh24yL7EtLZxoGE+Q4HAZl2QYr2cnGGC1ZZK9ak3/6RPdNbv/2qS5W5Z16oKrXSXVZPGbsdANxhV31S+qf1SJJSx4KCm611zPCJ52VUAmweGJKZzp5QExJhLU4SgJ7ifGNwl9pjUc65/XtHENCQIXxMxM256LXLQRwW1Jk6oU1GoZxqNRBGI72QBLLPfNfX01nLk6ed/8dsdN2pshdFV6U+/m9cGk3wJr8OyaHAmaucllKRuqkenvT4IrujWW5/wpXDwwn2CVc+lxSRdFgrdjTm5nnnCsqxGfOCY37pVFtwD1Q55czwYKsdax9L7VR1jPBeqCm23GIXLOjDvSxmuf0o588C1/oecSxFgXcxc7JHhlMsRl/WP0O62rOC6BdHJV0PKAGA+lnOwX6j+7bZ9rg9Il96B3LD5hk65ZleT6oQ68wjdDq0FxfufSoBYssfTuqjHGnVnLohaWGJ9XoJJNF3mmE6gT9wPc0k1Uy/yVS13J9kKx5bCgrzz6LwhNQLWcnmYVNRPXvprP5U555gKijCPEWGSYQqzQ0p4WcDVu1frPbO9vhBFG8CrFXzMqtHFumQDrAAAAAElFTkSuQmCC" alt="steam-circled">
                        <RadzenStack Gap="0">
                            <RadzenText Text="SteamID" TextStyle="Radzen.Blazor.TextStyle.Overline" TagName="Radzen.Blazor.TagName.H4" class="rz-mb-1" />
                            <RadzenText Style="word-break: break-all" Text="@player.MainInfo.SteamID" TagName="Radzen.Blazor.TagName.P" TextStyle="Radzen.Blazor.TextStyle.H5" />
                        </RadzenStack>
                    </RadzenStack>
                </RadzenCard>

                @* Порядочность *@
                <RadzenCard Variant="Radzen.Variant.Outlined">
                    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="1rem" AlignItems="Radzen.AlignItems.Center" Wrap="Radzen.FlexWrap.NoWrap">
                        <RadzenIcon Icon="clean_hands" class="rz-background-color-primary-light rz-color-on-primary-light rz-border-radius-10" Style="font-size: 32px; min-height: 56px; min-width: 56px" />
                        <RadzenStack Gap="0">
                            <RadzenText Text="Порядочость" TextStyle="Radzen.Blazor.TextStyle.Overline" TagName="Radzen.Blazor.TagName.H4" class="rz-mb-1" />
                            <RadzenText Style="word-break: break-all" Text="@player.BanMultiplier.ToString()" TagName="Radzen.Blazor.TagName.P" TextStyle="Radzen.Blazor.TextStyle.H5" />
                        </RadzenStack>
                    </RadzenStack>
                </RadzenCard>

                @*AVG*@
                <RadzenCard Variant="Radzen.Variant.Outlined">
                    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="1rem" AlignItems="Radzen.AlignItems.Center" Wrap="Radzen.FlexWrap.NoWrap">
                        <RadzenIcon Icon="area_chart" class="rz-background-color-primary-light rz-color-on-primary-light rz-border-radius-10" Style="font-size: 32px; min-height: 56px; min-width: 56px" />
                        <RadzenStack Gap="0">
                            <RadzenText Text="AVG" TextStyle="Radzen.Blazor.TextStyle.Overline" TagName="Radzen.Blazor.TagName.H4" class="rz-mb-1" />
                            <RadzenText Style="word-break: break-all" Text="@player.MainInfo.AVG.ToString()" TagName="Radzen.Blazor.TagName.P" TextStyle="Radzen.Blazor.TextStyle.H5" />
                        </RadzenStack>
                    </RadzenStack>
                </RadzenCard>

                @*HSR*@
                <RadzenCard Variant="Radzen.Variant.Outlined">
                    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="1rem" AlignItems="Radzen.AlignItems.Center" Wrap="Radzen.FlexWrap.NoWrap">
                        <RadzenIcon Icon="insert_chart" class="rz-background-color-primary-light rz-color-on-primary-light rz-border-radius-10" Style="font-size: 32px; min-height: 56px; min-width: 56px" />
                        <RadzenStack Gap="0">
                            <RadzenText Text="HS" TextStyle="Radzen.Blazor.TextStyle.Overline" TagName="Radzen.Blazor.TagName.H4" class="rz-mb-1" />
                            <RadzenText Style="word-break: break-all" Text="@player.MainInfo.HSR.ToString()" TagName="Radzen.Blazor.TagName.P" TextStyle="Radzen.Blazor.TextStyle.H5" />
                        </RadzenStack>
                    </RadzenStack>
                </RadzenCard>

                @*4K*@
                <RadzenCard Variant="Radzen.Variant.Outlined">
                    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="1rem" AlignItems="Radzen.AlignItems.Center" Wrap="Radzen.FlexWrap.NoWrap">
                        <RadzenIcon Icon="4k" class="rz-background-color-primary-light rz-color-on-primary-light rz-border-radius-10" Style="font-size: 32px; min-height: 56px; min-width: 56px" />
                        <RadzenStack Gap="0">
                            <RadzenText Text="Квадро" TextStyle="Radzen.Blazor.TextStyle.Overline" TagName="Radzen.Blazor.TagName.H4" class="rz-mb-1" />
                            <RadzenText Style="word-break: break-all" Text="@player.Highlights.Quadros.ToString()" TagName="Radzen.Blazor.TagName.P" TextStyle="Radzen.Blazor.TextStyle.H5" />
                        </RadzenStack>
                    </RadzenStack>
                </RadzenCard>

                @*5K*@
                <RadzenCard Variant="Radzen.Variant.Outlined">
                    <RadzenStack Orientation="Radzen.Orientation.Horizontal" Gap="1rem" AlignItems="Radzen.AlignItems.Center" Wrap="Radzen.FlexWrap.NoWrap">
                        <RadzenIcon Icon="5k" class="rz-background-color-primary-light rz-color-on-primary-light rz-border-radius-10" Style="font-size: 32px; min-height: 56px; min-width: 56px" />
                        <RadzenStack Gap="0">
                            <RadzenText Text="Эйсы" TextStyle="Radzen.Blazor.TextStyle.Overline" TagName="Radzen.Blazor.TagName.H4" class="rz-mb-1" />
                            <RadzenText Style="word-break: break-all" Text="@player.Highlights.Aces.ToString()" TagName="Radzen.Blazor.TagName.P" TextStyle="Radzen.Blazor.TextStyle.H5" />
                        </RadzenStack>
                    </RadzenStack>
                </RadzenCard>
            </RadzenStack>
        </RadzenColumn>
    </RadzenRow>
</RadzenCard>

@code {
    [Parameter] public PlayerInfo player { get; set; }

    void ShowTooltipWithHtml(ElementReference elementReference, int kills, int deaths, TooltipOptions options = null) => tooltipService.Open(elementReference, ds =>
    @<div>
        <b>@kills/@deaths</b>
    </div>, options);

    void ShowTotalMatches(ElementReference elementReference, int matches, TooltipOptions options = null) => tooltipService.Open(elementReference, ds =>
    @<div>
        Сыграно матчей: <b>@matches</b>
    </div>, options);

    async Task ShowDialog(string message)
    {
        await DialogService.OpenAsync("", ds =>
        {
            RenderFragment content = dialogContent =>
            {
                dialogContent.OpenComponent<RadzenRow>(0);
                dialogContent.AddComponentParameter(1, nameof(RadzenRow.ChildContent), (RenderFragment)(rowContent => 
                {
                    rowContent.OpenComponent<RadzenColumn>(0);
                    rowContent.AddComponentParameter(1, nameof(RadzenColumn.Size), 12);
                    rowContent.AddComponentParameter(2, nameof(RadzenRow.ChildContent), (RenderFragment)(columnContent => 
                    {
                        columnContent.AddContent(0, message);
                    }));
                    rowContent.CloseComponent();
                }));

                dialogContent.CloseComponent();
            };
            return content;
        }, new DialogOptions() { ShowTitle = false, Style = "min-height:auto;min-width:auto;width:auto", CloseDialogOnEsc = true, CloseDialogOnOverlayClick = true });
    }
}
